@model MainOps.Models.CompareTwoSnapShots

@{
    ViewData["Title"] = "Basis for Invoice";
    var thevaluta = "";
    var firstitem = Model.SnapShot2.Items.Where(x => x.ItemTypeId != 0).FirstOrDefault();

    @if (firstitem != null)
    {
        if (firstitem.ItemType.Valuta.Equals("EURO"))
        {
            thevaluta = "€";
        }
        else
        {
            thevaluta = "DKK";
        }
    }
    else
    {
        var firstextraitem = Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null).FirstOrDefault();
        if (firstextraitem != null)
        {
            thevaluta = firstextraitem.ExtraWork.Valuta;
        }
        else
        {
            thevaluta = "DKK";
        }

    }}
<style>
    .IsAlteredOld {
        border: 2px solid red;
    }

    table {
        width: 100%;
        margin-left: 5px;
        margin-right: 5px;
    }

    .namecol {
        width: 25%;
    }

    .dayscol {
        width: 10%;
    }

    .moneycol {
        width: 15%;
    }

    .amountcol {
        width: 5%;
    }

    .locationcol {
        width: 5%;
    }

    .typecol {
        width: 10%;
    }

    .crossedout {
        background: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' preserveAspectRatio='none' viewBox='0 0 100 100'><path d='M100 0 L0 100 ' stroke='black' stroke-width='1'/><path d='M0 0 L100 100 ' stroke='black' stroke-width='1'/></svg>");
        background-repeat: no-repeat;
        background-position: center center;
        background-size: 100% 100%, auto;
    }
</style>
<div class="row">
    <table>
        <tr>
            <td>
                <form asp-action="SnapShotPDF" method="get" target="_blank">
                    <input name="SnapShot1Id" value="@Model.SnapShot1.Id" hidden="hidden" />
                    <input name="SnapShot2Id" value="@Model.SnapShot2.Id" hidden="hidden" />
                    <input name="orderbyoption" value="@ViewBag.OrderByOption" hidden="hidden" />
                    <input name="TheSnapShotNumber" value="1" hidden="hidden" />
                    <button class="btn-hoelscher">@SharedLocalizer.GetLocalizedHtmlString("Print First Snapshot (.pdf")</button>
                </form>
            </td>
            <td>
                <form asp-action="SnapShot1Excel" method="get">
                    <input name="SnapShot1Id" value="@Model.SnapShot1.Id" hidden="hidden" />
                    <input name="SnapShot2Id" value="@Model.SnapShot2.Id" hidden="hidden" />
                    <input name="orderbyoption" value="@ViewBag.OrderByOption" hidden="hidden" />
                    <button class="btn-hoelscher">@SharedLocalizer.GetLocalizedHtmlString("Print First SnapShot (.csv)")</button>
                </form>
            </td>
        </tr>
        <tr>
            <td>
                <form asp-action="SnapShotPDF" method="get" target="_blank">
                    <input name="SnapShot1Id" value="@Model.SnapShot1.Id" hidden="hidden" />
                    <input name="SnapShot2Id" value="@Model.SnapShot2.Id" hidden="hidden" />
                    <input name="orderbyoption" value="@ViewBag.OrderByOption" hidden="hidden" />
                    <input name="TheSnapShotNumber" value="2" hidden="hidden" />
                    <button class="btn-hoelscher">@SharedLocalizer.GetLocalizedHtmlString("Print Second Snapshot (.pdf")</button>
                </form>
            </td>
            <td>
                <form asp-action="SnapShot2Excel" method="get">
                    <input name="SnapShot1Id" value="@Model.SnapShot1.Id" hidden="hidden" />
                    <input name="SnapShot2Id" value="@Model.SnapShot2.Id" hidden="hidden" />
                    <input name="orderbyoption" value="@ViewBag.OrderByOption" hidden="hidden" />
                    <button class="btn-hoelscher">@SharedLocalizer.GetLocalizedHtmlString("Print Second SnapShot (.csv)")</button>
                </form>
            </td>
        </tr>
    </table>
</div>
<div class="row">
    <div style="width:100%;">

        <h2>@SharedLocalizer.GetLocalizedHtmlString("This Period")</h2>

        @{ var totaltotalcost = (decimal)0.0;
            var numRecords = 0;
        }
        <div style="width:50%;height:1000px;overflow-y:scroll;overflow-x:scroll;float:left;border:2px solid blue;">
            @foreach (var boqheadline in Model.SnapShot1.Project.BoQHeadlines.OrderBy(x => x.BoQnum).ThenBy(x => x.HeadLine))
            {
                if (boqheadline.Type.Equals("Mobilisation"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.MobilizationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        var cost = (decimal)0.0;
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.MobilizationId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {
                                    var subtotal = Convert.ToDecimal(item.price);
                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    cost += subtotal;
                                    totaltotalcost += subtotal;
                                    if (item.Total_Discount_Installation > (decimal)0.01)
                                    {

                                        <tr>
                                            <td colspan="7" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                            <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount_Installation)@thevaluta</td>
                                        </tr>

                                        cost -= (decimal)item.Total_Discount_Installation;
                                        totaltotalcost -= (decimal)item.Total_Discount_Installation;
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Installation"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.InstallationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        var cost = (decimal)0.0;
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.InstallationId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {
                                    var subtotal = Convert.ToDecimal(item.price);
                                    if (item.IsAltered == true)
                                    {
                                <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                    @if (item.Install != null)
                                    {
                                        @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                        {
                                            <td> @item.Item_Name : @item.Install.UniqueID </td>
                                        }
                                        else
                                        {
                                            <td> @item.Item_Name </td>
                                        }
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }

                                    <td> @item.ItemType.Item_Type </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                            <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" class="crossedout">
                                @if (item.Install != null)
                                {
                                    @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Install.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td> @item.ItemType.Item_Type </td>
                                <td>@item.location </td>
                                <td> @String.Format("{0:N2} ", item.Amount) </td>
                                <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                @if (item.EndStamp != null)
                                {
                                    <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td> @item.Days </td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }

                            </tr>
                                    }
                                    else
                                    {
                            <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                @if (item.Install != null)
                                {
                                    @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Install.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td> @item.ItemType.Item_Type </td>
                                <td>@item.location </td>
                                <td> @String.Format("{0:N2} ", item.Amount) </td>
                                <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                @if (item.EndStamp != null)
                                {
                                    <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td> @item.Days </td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }

                            </tr>
                                    }
                                    cost += subtotal;
                                    totaltotalcost += subtotal;
                                    if (item.Total_Discount_Installation > (decimal)0.01)
                                    {

                                        <tr>
                                            <td colspan="7" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                            <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount_Installation)@thevaluta</td>
                                        </tr>
                                        cost -= (decimal)item.Total_Discount_Installation;
                                        totaltotalcost -= (decimal)item.Total_Discount_Installation;
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Rental"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.ArrivalId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        var cost = (decimal)0.0;
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.ArrivalId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {
                                    string locationextension = "";
                                    if(item.location != null) {
                                        if (item.location.Contains("("))
                                        {
                                            locationextension = String.Concat("(", item.location.Split(")")[0].Split("(")[1], ")");
                                        }
                                    }
                                    var subtotal = Convert.ToDecimal(item.ItemType.rental_price * (decimal)item.Days * (decimal)item.Amount);
                                    if (item.IsAltered == true)
                                    {
                                <tr id="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="isAlteredOld">
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td> @item.ItemType.Item_Type </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                            <tr id="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                {
                                    <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td> @item.ItemType.Item_Type </td>
                                <td>@item.location </td>
                                <td> @String.Format("{0:N2} ", item.Amount) </td>
                                <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                @if (item.EndStamp != null)
                                {
                                    <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td> @item.Days </td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }

                            </tr>
                                    }
                                    else
                                    {

                            <tr id="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                {
                                    <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td> @item.ItemType.Item_Type </td>
                                <td>@item.location </td>
                                <td> @String.Format("{0:N2} ", item.Amount) </td>
                                <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                @if (item.EndStamp != null)
                                {
                                    <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td> @item.Days </td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }

                            </tr>
                                    }

                                    cost += subtotal;
                                    totaltotalcost += subtotal;
                                    if (item.Total_Discount > (decimal)0.01)
                                    {
                                        <tr>
                                            <td colspan="7" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                            <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount)@thevaluta</td>
                                        </tr>

                                        cost -= (decimal)item.Total_Discount;
                                        totaltotalcost -= (decimal)item.Total_Discount;
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Hours"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.Daily_Report_2Id != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        var cost = (decimal)0.0;
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.Daily_Report_2Id != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {
                                    var subtotal = (decimal)0.0;
                                    @if (item.rental_price != null && item.price != null)
                                    {
                                        subtotal = Convert.ToDecimal(item.rental_price) + Convert.ToDecimal(item.price);
                                    }
                                    else
                                    {
                                        if (item.rental_price != null)
                                        {
                                            subtotal = Convert.ToDecimal(item.rental_price);
                                        }
                                        else
                                        {
                                            subtotal = Convert.ToDecimal(item.price);
                                        }
                                    }
                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    cost += subtotal;
                                    totaltotalcost += subtotal;
                                    if (item.Total_Discount > (decimal)0.01)
                                    {
                                        <tr>
                                            <td colspan="7" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                            <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount)@thevaluta</td>
                                        </tr>

                                        cost -= (decimal)item.Total_Discount;
                                        totaltotalcost -= (decimal)item.Total_Discount;
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("ExtraWork"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        var cost = (decimal)0.0;
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id) && x.FullPeriod == false))
                                {
                                    var subtotal = (decimal)0.0;
                                    @if (item.rental_price != null && item.price != null)
                                    {
                                        subtotal = Convert.ToDecimal(item.rental_price) + Convert.ToDecimal(item.price);
                                    }
                                    else
                                    {
                                        if (item.rental_price != null)
                                        {
                                            subtotal = Convert.ToDecimal(item.rental_price);
                                        }
                                        else
                                        {
                                            subtotal = Convert.ToDecimal(item.price);
                                        }
                                    }
                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    cost += subtotal;
                                    totaltotalcost += subtotal;
                                }
                            </tbody>
                        </table>
                    }
                }
                else
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id)))
                                {

                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }


            }

        </div>
        <div style="width:50%;height:1000px;overflow-y:scroll;overflow-x:scroll;float:right;border:2px solid blue;">
            @foreach (var boqheadline in Model.SnapShot1.Project.BoQHeadlines.OrderBy(x => x.BoQnum).ThenBy(x => x.HeadLine))
            {
                if (boqheadline.Type.Equals("Mobilisation"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.MobilizationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.MobilizationId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            <td>@String.Format("{0:N2} ", item.price)</td>
                                            <td>@String.Format("{0:N2} ", item.rental_price)</td>
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Installation"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.InstallationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.InstallationId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {
                                    if (item.IsNew == true)
                                    {
                                <tr style="background-color:lawngreen;">
                                    @if (item.Install != null)
                                    {
                                        @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                        {
                                            <td> @item.Item_Name : @item.Install.UniqueID </td>
                                        }
                                        else
                                        {
                                            <td> @item.Item_Name </td>
                                        }
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.ItemType.Item_Type</td>
                                    <td>@item.location</td>
                                    <td>@String.Format("{0:N2} ", item.Amount)</td>
                                    <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td>@item.Days</td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                            <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                @if (item.Install != null)
                                {
                                    @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Install.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td>@item.ItemType.Item_Type</td>
                                <td>@item.location</td>
                                <td>@String.Format("{0:N2} ", item.Amount)</td>
                                <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                @if (item.EndStamp != null)
                                {
                                    <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td>@item.Days</td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                            </tr>
                                    }
                                    else
                                    {
                            <tr>
                                @if (item.Install != null)
                                {
                                    @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Install.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td>@item.ItemType.Item_Type</td>
                                <td>@item.location</td>
                                <td>@String.Format("{0:N2} ", item.Amount)</td>
                                <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                @if (item.EndStamp != null)
                                {
                                    <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td>@item.Days</td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }

                            </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Rental"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.ArrivalId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.ArrivalId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {
                                    string locationextension = "";
                                    if (item.location != null)
                                    {
                                        if (item.location.Contains("("))
                                        {
                                            locationextension = String.Concat("(", item.location.Split(")")[0].Split("(")[1], ")");
                                        }
                                    }
                                    if (item.IsNew == true)
                                    {
                                <tr style="background-color:lawngreen;">
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.ItemType.Item_Type</td>
                                    <td>@item.location</td>
                                    <td>@String.Format("{0:N2} ", item.Amount)</td>
                                    <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td>@item.Days</td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                            <tr title="@item.ChangeLog" data-content="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                {
                                    <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td>@item.ItemType.Item_Type</td>
                                <td>@item.location</td>
                                <td>@String.Format("{0:N2} ", item.Amount)</td>
                                <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                @if (item.EndStamp != null)
                                {
                                    <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td>@item.Days</td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                            </tr>
                                    }
                                    else
                                    {
                            <tr>
                                @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                {
                                    <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                }
                                else
                                {
                                    <td> @item.Item_Name </td>
                                }
                                <td>@item.ItemType.Item_Type</td>
                                <td>@item.location</td>
                                <td>@String.Format("{0:N2} ", item.Amount)</td>
                                <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                @if (item.EndStamp != null)
                                {
                                    <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td>@item.Days</td>
                                @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                {
                                    <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                }
                                else
                                {
                                    <td></td>
                                }

                            </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Hours"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.Daily_Report_2Id != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.Daily_Report_2Id != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("ExtraWork"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null && x.FullPeriod == false).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id) && x.FullPeriod == false))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id)))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }

                            </tbody>
                        </table>
                    }
                }


            }
        </div>

    </div>
    <div style="width:100%;">
        <h2>@SharedLocalizer.GetLocalizedHtmlString("All Time Period")</h2>

        <div style="width:50%;height:1000px;overflow-y:scroll;overflow-x:scroll;float:left;border:2px solid blue;">
            @foreach (var boqheadline in Model.SnapShot1.Project.BoQHeadlines.OrderBy(x => x.BoQnum).ThenBy(x => x.HeadLine))
            {
                if (boqheadline.Type.Equals("Mobilisation"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.MobilizationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.MobilizationId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {
                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }

                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Installation"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.InstallationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.InstallationId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {

                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Rental"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.ArrivalId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.ArrivalId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {
                                    string locationextension = "";
                                    if (item.location != null)
                                    {
                                        if (item.location.Contains("("))
                                        {
                                            locationextension = String.Concat("(", item.location.Split(")")[0].Split("(")[1], ")");
                                        }
                                    }
                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="isAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }

                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Hours"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.Daily_Report_2Id != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.Daily_Report_2Id != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {

                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("ExtraWork"))
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id) && x.FullPeriod == true))
                                {

                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="crossedout">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else
                {
                    numRecords = Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot1.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id)))
                                {

                                    if (item.IsAltered == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false" class="IsAlteredOld">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.WasRemoved == true)
                                    {
                                        <tr id="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id)" highlighted="false">
                                            <td> @item.Item_Name </td>
                                            <td> @item.ItemType.Item_Type </td>
                                            <td>@item.location </td>
                                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td> @item.Days </td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                                else
                                {

                                }
                            </tbody>
                        </table>
                    }
                }


            }

        </div>
        <div style="width:50%;height:1000px;overflow-y:scroll;overflow-x:scroll;float:right;border:2px solid blue;">
            @foreach (var boqheadline in Model.SnapShot1.Project.BoQHeadlines.OrderBy(x => x.BoQnum).ThenBy(x => x.HeadLine))
            {
                if (boqheadline.Type.Equals("Mobilisation"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.MobilizationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.MobilizationId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            <td>@String.Format("{0:N2} ", item.price)</td>
                                            <td>@String.Format("{0:N2} ", item.rental_price)</td>
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Installation"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.InstallationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.InstallationId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {
                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Rental"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.ArrivalId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.ArrivalId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {
                                    string locationextension = "";
                                    if (item.location != null)
                                    {
                                        if (item.location.Contains("("))
                                        {
                                            locationextension = String.Concat("(", item.location.Split(")")[0].Split("(")[1], ")");
                                        }
                                    }
                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(locationextension,"_",item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("Hours"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.Daily_Report_2Id != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.Daily_Report_2Id != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else if (boqheadline.Type.Equals("ExtraWork"))
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null && x.FullPeriod == true).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id) && x.FullPeriod == true))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }
                }
                else
                {
                    numRecords = Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null).Count();
                    if (numRecords > 0)
                    {
                        <h2>@boqheadline.HeadLine</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th class="namecol">ItemName</th>
                                    <th class="typecol">ItemType</th>
                                    <th class="locationcol">Location</th>
                                    <th class="amountcol">Amount</th>
                                    <th class="dayscol">Start Date</th>
                                    <th class="dayscol">End Date</th>
                                    <th class="amountcol">Days</th>
                                    <th class="moneycol">price</th>
                                    <th class="moneycol">rental price</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var item in Model.SnapShot2.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id)))
                                {

                                    if (item.IsNew == true)
                                    {
                                        <tr style="background-color:lawngreen;">
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                    else if (item.IsAltered == true)
                                    {

                                        <tr title="@item.ChangeLog" data-content="@String.Concat(item.isIdleItem,"_",item.FullPeriod,"_",item.InstallationId.ToString(), "_", item.ArrivalId.ToString(), "_", item.ExtraWorkId.ToString(), "_", item.Daily_Report_2Id.ToString())" style="background-color:orange;" onclick="myFunction(this)">
                                            @*onclick="FocusOldItem(@String.Concat(item.InstallationId, "_", item.ArrivalId, "_", item.ExtraWorkId, "_", item.Daily_Report_2Id));"*@
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                        </tr>
                                    }
                                    else
                                    {
                                        <tr>
                                            <td>@item.Item_Name</td>
                                            <td>@item.ItemType.Item_Type</td>
                                            <td>@item.location</td>
                                            <td>@String.Format("{0:N2} ", item.Amount)</td>
                                            <td>@item.Install_date.ToString("yyyy-MM-dd")</td>
                                            @if (item.EndStamp != null)
                                            {
                                                <td>@String.Format("{0:yyyy-MM-dd}", @item.EndStamp)</td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            <td>@item.Days</td>
                                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }
                                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                            {
                                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                            }
                                            else
                                            {
                                                <td></td>
                                            }

                                        </tr>
                                    }
                                }

                            </tbody>
                        </table>
                    }
                }


            }
        </div>

    </div>
</div>



@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        function myFunction(elem) {
            var highlightedtrs = document.querySelectorAll("[highlighted='true']");
            for (i = 0; i < highlightedtrs.length; ++i) {
                highlightedtrs[i].style.backgroundColor = "white";
                highlightedtrs[i].setAttribute("highlighted", "false");
            }
            var theid = elem.getAttribute('data-content');
            var x = document.getElementById(theid);
            x.focus();
            x.style.backgroundColor = "grey";
            x.setAttribute("highlighted", "true");
            window.location.assign('#' + theid);
            if (document.location.hash) {
                setTimeout(function () {
                    window.scrollTo(window.scrollX, window.scrollY - 100);
                }, 10);
            }

        }
    </script>
}



