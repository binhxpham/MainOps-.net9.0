@model MainOps.Models.InvoiceSnapShot
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Invoice</title>
    <link rel="stylesheet" href="@Url.Content("~/css/pdfcss.css")" />
    <style>
        .namecol {
            width: 25%;
        }

        .dayscol {
            width: 10%;
        }

        .moneycol {
            width: 15%;
        }

        .amountcol {
            width: 5%;
        }

        .locationcol {
            width: 5%;
        }

        .typecol {
            width: 10%;
        }

        td {
            margin: 0px;
            border-spacing: 0px;
        }

        .IsAlteredOld {
            border-top: 2px solid red;
            border-bottom: 2px solid red;
        }

        .IsAlteredOldleft {
            border-top: 2px solid red;
            border-bottom: 2px solid red;
            border-left: 2px solid red;
        }

        .IsAlteredOldright {
            border-top: 2px solid red;
            border-bottom: 2px solid red;
            border-right: 2px solid red;
        }
    </style>
</head>
@{
    Layout = null;
    var thevaluta = "";
    var firstitem = Model.Items.Where(x => x.ItemTypeId != 0).FirstOrDefault();

    @if (firstitem != null)
    {
        if (firstitem.ItemType.Valuta.Equals("EURO"))
        {
            thevaluta = "€";
        }
        else
        {
            thevaluta = "DKK";
        }
    }
    else
    {
        var firstextraitem = Model.Items.Where(x => x.ExtraWorkId != null).FirstOrDefault();
        if (firstextraitem != null)
        {
            thevaluta = firstextraitem.ExtraWork.Valuta;
        }
        else
        {
            thevaluta = "DKK";
        }

    }}

<div style="width:100%;">

    <h2>@SharedLocalizer.GetLocalizedHtmlString("This Period") @Model.SnapShotStartDate.ToShortDateString() - @Model.SnapShotEndDate.ToShortDateString()</h2>

    @{ var totaltotalcost = (decimal)0.0;
        var numRecords = 0;
    }
    @foreach (var boqheadline in Model.Project.BoQHeadlines.OrderBy(x => x.BoQnum).ThenBy(x => x.HeadLine))
    {
        if (boqheadline.Type.Equals("Mobilisation"))
        {
            numRecords = Model.Items.Where(x => x.MobilizationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
            if (numRecords > 0)
            {
                <h2>@boqheadline.HeadLine</h2>
                var cost = (decimal)0.0;
                <table>
                    <thead>
                        <tr>
                            <th class="namecol">ItemName</th>
                            <th class="locationcol">Location</th>
                            <th class="amountcol">Amount</th>
                            <th class="dayscol">Start Date</th>
                            <th class="dayscol">End Date</th>
                            <th class="amountcol">Days</th>
                            <th class="moneycol">price</th>
                            <th class="moneycol">rental price</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.Items.Where(x => x.MobilizationId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                        {
                            var subtotal = Convert.ToDecimal(item.price);
                            if (item.IsAltered == true)
                            {
                                <tr style="background-color:orange;">
                                    <td> @item.Item_Name</td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                <tr style="background-color:orange;">
                                    <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                </tr>
                            }
                            else if (item.IsNew == true)
                            {

                                <tr style="background-color:lawngreen;">
                                    <td> @item.Item_Name</td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>

                            }
                            else
                            {
                                <tr>
                                    <td> @item.Item_Name </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            cost += subtotal;
                            totaltotalcost += subtotal;
                            if (item.Total_Discount_Installation > (decimal)0.01)
                            {

                                <tr>
                                    <td colspan="6" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                    <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount_Installation)@thevaluta</td>
                                </tr>

                                cost -= (decimal)item.Total_Discount_Installation;
                                totaltotalcost -= (decimal)item.Total_Discount_Installation;
                            }
                        }
                    </tbody>
                </table>
            }
        }
        else if (boqheadline.Type.Equals("Installation"))
        {
            numRecords = Model.Items.Where(x => x.InstallationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
            if (numRecords > 0)
            {
                <h2>@boqheadline.HeadLine</h2>
                var cost = (decimal)0.0;
                <table>
                    <thead>
                        <tr>
                            <th class="namecol">ItemName</th>
                            <th class="locationcol">Location</th>
                            <th class="amountcol">Amount</th>
                            <th class="dayscol">Start Date</th>
                            <th class="dayscol">End Date</th>
                            <th class="amountcol">Days</th>
                            <th class="moneycol">price</th>
                            <th class="moneycol">rental price</th>
                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var item in Model.Items.Where(x => x.InstallationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                        {
                            var subtotal = Convert.ToDecimal(item.price);
                            if (item.IsAltered == true)
                            {
                                <tr style="background-color:orange;">
                                    @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Install.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                <tr style="background-color:orange;">
                                    <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                </tr>
                            }
                            else if (item.IsNew == true)
                            {
                                <tr style="background-color:lawngreen;">
                                    @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Install.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            else
                            {
                                <tr>
                                    @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Install.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            cost += subtotal;
                            totaltotalcost += subtotal;
                            if (item.Total_Discount_Installation > (decimal)0.01)
                            {

                                <tr>
                                    <td colspan="6" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                    <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount_Installation)@thevaluta</td>
                                </tr>
                                cost -= (decimal)item.Total_Discount_Installation;
                                totaltotalcost -= (decimal)item.Total_Discount_Installation;
                            }
                        }
                    </tbody>
                </table>
            }
        }
        else if (boqheadline.Type.Equals("Rental"))
        {
            numRecords = Model.Items.Where(x => x.ArrivalId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
            if (numRecords > 0)
            {
                <h2>@boqheadline.HeadLine</h2>
                var cost = (decimal)0.0;
                <table>
                    <thead>
                        <tr>
                            <th class="namecol">ItemName</th>
                            <th class="locationcol">Location</th>
                            <th class="amountcol">Amount</th>
                            <th class="dayscol">Start Date</th>
                            <th class="dayscol">End Date</th>
                            <th class="amountcol">Days</th>
                            <th class="moneycol">price</th>
                            <th class="moneycol">rental price</th>
                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var item in Model.Items.Where(x => x.ArrivalId != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                        {
                            var subtotal = Convert.ToDecimal(item.ItemType.rental_price * (decimal)item.Days * (decimal)item.Amount);
                            if (item.IsAltered == true)
                            {
                                <tr style="background-color:orange;">
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                <tr style="background-color:orange;">
                                    <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                </tr>
                            }
                            else if (item.IsNew == true)
                            {
                                <tr style="background-color:lawngreen;">
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            else
                            {
                                <tr>
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }

                            cost += subtotal;
                            totaltotalcost += subtotal;
                            if (item.Total_Discount > (decimal)0.01)
                            {
                                <tr>
                                    <td colspan="6" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                    <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount)@thevaluta</td>
                                </tr>

                                cost -= (decimal)item.Total_Discount;
                                totaltotalcost -= (decimal)item.Total_Discount;
                            }
                        }
                    </tbody>
                </table>
            }
        }
        else if (boqheadline.Type.Equals("Hours"))
        {
            numRecords = Model.Items.Where(x => x.Daily_Report_2Id != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false).Count();
            if (numRecords > 0)
            {
                <h2>@boqheadline.HeadLine</h2>
                var cost = (decimal)0.0;
                <table>
                    <thead>
                        <tr>
                            <th class="namecol">ItemName</th>
                            <th class="locationcol">Location</th>
                            <th class="amountcol">Amount</th>
                            <th class="dayscol">Start Date</th>
                            <th class="dayscol">End Date</th>
                            <th class="amountcol">Days</th>
                            <th class="moneycol">price</th>
                            <th class="moneycol">rental price</th>
                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var item in Model.Items.Where(x => x.Daily_Report_2Id != null && x.FullPeriod == false && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == false))
                        {
                            var subtotal = (decimal)0.0;
                            @if (item.rental_price != null && item.price != null)
                            {
                                subtotal = Convert.ToDecimal(item.rental_price) + Convert.ToDecimal(item.price);
                            }
                            else
                            {
                                if (item.rental_price != null)
                                {
                                    subtotal = Convert.ToDecimal(item.rental_price);
                                }
                                else
                                {
                                    subtotal = Convert.ToDecimal(item.price);
                                }
                            }
                            if (item.IsAltered == true)
                            {
                                <tr style="background-color:orange;">
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                <tr style="background-color:orange;">
                                    <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                </tr>
                            }
                            else if (item.IsNew == true)
                            {
                                <tr style="background-color:lawngreen;">
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            else
                            {
                                <tr>
                                    @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                    {
                                        <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                    }
                                    else
                                    {
                                        <td> @item.Item_Name </td>
                                    }
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            cost += subtotal;
                            totaltotalcost += subtotal;
                            if (item.Total_Discount > (decimal)0.01)
                            {
                                <tr>
                                    <td colspan="6" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Discount")</td>
                                    <td style="text-align:right;">@String.Format("{0:N2} ", -item.Total_Discount)@thevaluta</td>
                                </tr>

                                cost -= (decimal)item.Total_Discount;
                                totaltotalcost -= (decimal)item.Total_Discount;
                            }
                        }
                    </tbody>
                </table>
            }
        }
        else if (boqheadline.Type.Equals("ExtraWork"))
        {
            numRecords = Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null && x.FullPeriod == false).Count();
            if (numRecords > 0)
            {
                var cost = (decimal)0.0;
                <h2>@boqheadline.HeadLine</h2>
                <table>
                    <thead>
                        <tr>
                            <th class="namecol">ItemName</th>
                            <th class="locationcol">Location</th>
                            <th class="amountcol">Amount</th>
                            <th class="dayscol">Start Date</th>
                            <th class="dayscol">End Date</th>
                            <th class="amountcol">Days</th>
                            <th class="moneycol">price</th>
                            <th class="moneycol">rental price</th>
                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var item in Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id) && x.FullPeriod == false))
                        {
                            var subtotal = (decimal)0.0;
                            @if (item.rental_price != null && item.price != null)
                            {
                                subtotal = Convert.ToDecimal(item.rental_price) + Convert.ToDecimal(item.price);
                            }
                            else
                            {
                                if (item.rental_price != null)
                                {
                                    subtotal = Convert.ToDecimal(item.rental_price);
                                }
                                else
                                {
                                    subtotal = Convert.ToDecimal(item.price);
                                }
                            }
                            if (item.IsAltered == true)
                            {
                                <tr style="background-color:orange;">
                                    <td> @item.Item_Name </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                <tr style="background-color:orange;">
                                    <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                </tr>
                            }
                            else if (item.IsNew == true)
                            {
                                <tr style="background-color:lawngreen;">
                                    <td> @item.Item_Name </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            else
                            {
                                <tr>
                                    <td> @item.Item_Name </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            cost += subtotal;
                            totaltotalcost += subtotal;
                        }
                    </tbody>
                </table>
            }
        }
        else
        {
            numRecords = Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null).Count();
            if (numRecords > 0)
            {
                <h2>@boqheadline.HeadLine</h2>
                <table>
                    <thead>
                        <tr>
                            <th class="namecol">ItemName</th>
                            <th class="locationcol">Location</th>
                            <th class="amountcol">Amount</th>
                            <th class="dayscol">Start Date</th>
                            <th class="dayscol">End Date</th>
                            <th class="amountcol">Days</th>
                            <th class="moneycol">price</th>
                            <th class="moneycol">rental price</th>
                        </tr>
                    </thead>
                    <tbody>

                        @foreach (var item in Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id)))
                        {

                            if (item.IsAltered == true)
                            {
                                <tr style="background-color:orange;">
                                    <td> @item.Item_Name </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                                <tr style="background-color:orange;">
                                    <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                </tr>
                            }
                            else if (item.IsNew == true)
                            {
                                <tr style="background-color:lawngreen;">
                                    <td> @item.Item_Name </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                            else
                            {
                                <tr>
                                    <td> @item.Item_Name </td>
                                    <td>@item.location </td>
                                    <td> @String.Format("{0:N2} ", item.Amount) </td>
                                    <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                    @if (item.EndStamp != null)
                                    {
                                        <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    <td> @item.Days </td>
                                    @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                    @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                    {
                                        <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }

                                </tr>
                            }
                        }
                    </tbody>
                </table>
            }
        }


    }

</div>
<div style="width:100%;">
    <h2>@SharedLocalizer.GetLocalizedHtmlString("All Time Period") => @Model.SnapShotEndDate.ToShortDateString()</h2>

    <div style="width:100%;">
        @foreach (var boqheadline in Model.Project.BoQHeadlines.OrderBy(x => x.BoQnum).ThenBy(x => x.HeadLine))
        {
            if (boqheadline.Type.Equals("Mobilisation"))
            {
                numRecords = Model.Items.Where(x => x.MobilizationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                if (numRecords > 0)
                {
                    <h2>@boqheadline.HeadLine</h2>
                    <table>
                        <thead>
                            <tr>
                                <th class="namecol">ItemName</th>
                                <th class="locationcol">Location</th>
                                <th class="amountcol">Amount</th>
                                <th class="dayscol">Start Date</th>
                                <th class="dayscol">End Date</th>
                                <th class="amountcol">Days</th>
                                <th class="moneycol">price</th>
                                <th class="moneycol">rental price</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model.Items.Where(x => x.MobilizationId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                            {
                                if (item.IsAltered == true)
                                {
                                    <tr style="background-color:orange;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                    <tr style="background-color:orange;">
                                        <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                    </tr>
                                }
                                else if (item.IsNew == true)
                                {
                                    <tr style="background-color:lawngreen;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                                else
                                {
                                    <tr >
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }

                            }
                        </tbody>
                    </table>
                }
            }
            else if (boqheadline.Type.Equals("Installation"))
            {
                numRecords = Model.Items.Where(x => x.InstallationId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                if (numRecords > 0)
                {
                    <h2>@boqheadline.HeadLine</h2>
                    <table>
                        <thead>
                            <tr>
                                <th class="namecol">ItemName</th>
                                <th class="locationcol">Location</th>
                                <th class="amountcol">Amount</th>
                                <th class="dayscol">Start Date</th>
                                <th class="dayscol">End Date</th>
                                <th class="amountcol">Days</th>
                                <th class="moneycol">price</th>
                                <th class="moneycol">rental price</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model.Items.Where(x => x.InstallationId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                            {

                                if (item.IsAltered == true)
                                {
                                    <tr style="background-color:orange;">
                                        @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                        {
                                            <td> @item.Item_Name : @item.Install.UniqueID </td>
                                        }
                                        else
                                        {
                                            <td> @item.Item_Name </td>
                                        }
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                    <tr style="background-color:orange;">
                                        <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                    </tr>
                                }
                                else if (item.IsNew == true)
                                {
                                    <tr background-color:lawngreen;">
                                        @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                        {
                                            <td> @item.Item_Name : @item.Install.UniqueID </td>
                                        }
                                        else
                                        {
                                            <td> @item.Item_Name </td>
                                        }
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                                else
                                {
                                    <tr >
                                        @if (item.Install.UniqueID != "N/A" && item.Install.UniqueID != null)
                                        {
                                            <td> @item.Item_Name : @item.Install.UniqueID </td>
                                        }
                                        else
                                        {
                                            <td> @item.Item_Name </td>
                                        }
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                }
            }
            else if (boqheadline.Type.Equals("Rental"))
            {
                numRecords = Model.Items.Where(x => x.ArrivalId != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                if (numRecords > 0)
                {
                    <h2>@boqheadline.HeadLine</h2>
                    <table>
                        <thead>
                            <tr>
                                <th class="namecol">ItemName</th>
                                <th class="locationcol">Location</th>
                                <th class="amountcol">Amount</th>
                                <th class="dayscol">Start Date</th>
                                <th class="dayscol">End Date</th>
                                <th class="amountcol">Days</th>
                                <th class="moneycol">price</th>
                                <th class="moneycol">rental price</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model.Items.Where(x => x.ArrivalId != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                            {
                                if (item.IsAltered == true)
                                {
                                    <tr style="background-color:orange;">
                                        @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                        {
                                            <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                        }
                                        else
                                        {
                                            <td> @item.Item_Name </td>
                                        }
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                    <tr style="background-color:orange;">
                                        <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                    </tr>
                                }
                                else if (item.IsNew == true)
                                {
                                    <tr style="background-color:lawngreen;">
                                        @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                                        {
                                            <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                                        }
                                        else
                                        {
                                            <td> @item.Item_Name </td>
                                        }
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                            else
                            {
                        <tr>
                            @if (item.Arrival.UniqueID != "N/A" && item.Arrival.UniqueID != null)
                            {
                                <td> @item.Item_Name : @item.Arrival.UniqueID </td>
                            }
                            else
                            {
                                <td> @item.Item_Name </td>
                            }
                            <td>@item.location </td>
                            <td> @String.Format("{0:N2} ", item.Amount) </td>
                            <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                            @if (item.EndStamp != null)
                            {
                                <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                            }
                            else
                            {
                                <td></td>
                            }
                            <td> @item.Days </td>
                            @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                            {
                                <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                            }
                            else
                            {
                                <td></td>
                            }
                            @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                            {
                                <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                            }
                            else
                            {
                                <td></td>
                            }

                        </tr>
                            }
                                
                            }
                        </tbody>
                    </table>
                }
            }
            else if (boqheadline.Type.Equals("Hours"))
            {
                numRecords = Model.Items.Where(x => x.Daily_Report_2Id != null && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0) && x.FullPeriod == true).Count();
                if (numRecords > 0)
                {
                    <h2>@boqheadline.HeadLine</h2>
                    <table>
                        <thead>
                            <tr>
                                <th class="namecol">ItemName</th>
                                <th class="locationcol">Location</th>
                                <th class="amountcol">Amount</th>
                                <th class="dayscol">Start Date</th>
                                <th class="dayscol">End Date</th>
                                <th class="amountcol">Days</th>
                                <th class="moneycol">price</th>
                                <th class="moneycol">rental price</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model.Items.Where(x => x.Daily_Report_2Id != null && x.FullPeriod == true && x.BoQNr >= boqheadline.BoQnum && x.BoQNr < (boqheadline.BoQnum + (decimal)1.0)))
                            {

                                if (item.IsAltered == true)
                                {
                                    <tr style="background-color:orange;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                    <tr style="background-color:orange;">
                                        <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                    </tr>
                                }
                                else if (item.IsNew == true)
                                {
                                    <tr style="background-color:lawngreen;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                                else
                                {
                                    <tr >
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                }
            }
            else if (boqheadline.Type.Equals("ExtraWork"))
            {
                numRecords = Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null && x.FullPeriod == true).Count();
                if (numRecords > 0)
                {
                    <h2>@boqheadline.HeadLine</h2>
                    <table>
                        <thead>
                            <tr>
                                <th class="namecol">ItemName</th>
                                <th class="locationcol">Location</th>
                                <th class="amountcol">Amount</th>
                                <th class="dayscol">Start Date</th>
                                <th class="dayscol">End Date</th>
                                <th class="amountcol">Days</th>
                                <th class="moneycol">price</th>
                                <th class="moneycol">rental price</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id) && x.FullPeriod == true))
                            {

                                if (item.IsAltered == true)
                                {
                                    <tr style="background-color:orange;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                    <tr style="background-color:orange;">
                                        <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                    </tr>
                                }
                                else if (item.IsNew == true)
                                {
                                    <tr style="background-color:lawngreen;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                                else
                                {
                                    <tr>
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                }
            }
            else
            {
                numRecords = Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId == null).Count();
                if (numRecords > 0)
                {
                    <h2>@boqheadline.HeadLine</h2>
                    <table>
                        <thead>
                            <tr>
                                <th class="namecol">ItemName</th>
                                <th class="locationcol">Location</th>
                                <th class="amountcol">Amount</th>
                                <th class="dayscol">Start Date</th>
                                <th class="dayscol">End Date</th>
                                <th class="amountcol">Days</th>
                                <th class="moneycol">price</th>
                                <th class="moneycol">rental price</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var item in Model.Items.Where(x => x.ExtraWorkId != null && x.ExtraWork.BoQHeadLineId.Equals(boqheadline.Id)))
                            {

                                if (item.IsAltered == true)
                                {
                                    <tr style="background-color:orange;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                    <tr style="background-color:orange;">
                                        <td colspan="8" style="width:100%;text-align:center;">@item.ChangeLog</td>
                                    </tr>
                                }
                                else if (item.IsNew)
                                {
                                    <tr style="background-color:lawngreen;">
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                                else
                                {
                                    <tr>
                                        <td> @item.Item_Name </td>
                                        <td>@item.location </td>
                                        <td> @String.Format("{0:N2} ", item.Amount) </td>
                                        <td> @item.Install_date.ToString("yyyy-MM-dd") </td>
                                        @if (item.EndStamp != null)
                                        {
                                            <td> @String.Format("{0:yyyy-MM-dd}", @item.EndStamp) </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        <td> @item.Days </td>
                                        @if (item.price > (decimal)0.0001 || item.price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }
                                        @if (item.rental_price > (decimal)0.0001 || item.rental_price < (decimal)-0.0001)
                                        {
                                            <td> @String.Format("{0:N2} ", item.rental_price)@thevaluta </td>
                                        }
                                        else
                                        {
                                            <td></td>
                                        }

                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                }
            }


        }
    </div>
</div>








