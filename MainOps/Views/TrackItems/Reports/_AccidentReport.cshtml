@model MainOps.Models.ReportClasses.AccidentReport

@{
    Layout = null;
}
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@SharedLocalizer.GetLocalizedHtmlString("QHSE Report")</title>
    <link rel="stylesheet" href="@Url.Content("~/css/pdfcss.css")" />
</head>

<table style="width:100%;table-layout:fixed;">
    <tr>
        <td colspan="3">
            <b>@SharedLocalizer.GetLocalizedHtmlString("Accident Report")</b>
        </td>
    </tr>
    <tr>
        <td style="text-align:left;">
            <b>
                @Html.DisplayNameFor(x => x.Project.Name)
            </b>
        </td>
        <td>
            @Html.DisplayFor(x => x.Project.Name)
        </td>
        <td rowspan="4" align="right"><img src="~/images/Divisions/Photos/@Model.Project.Division.Id/@Model.Project.Division.LogoPath" width="151" height="66" /></td>
    </tr>
    <tr>
        <td style="text-align:left;">
            <b>
                @Html.DisplayNameFor(x => x.Project.ProjectNr)
            </b>
        </td>
        <td>
            @Html.DisplayFor(x => x.Project.ProjectNr)
        </td>
    </tr>
    <tr>
        <td style="text-align:left;">
            <b>
                @Html.DisplayNameFor(x => x.Project.Client)
            </b>
        </td>
        <td>
            @Html.DisplayFor(x => x.Project.Client)
        </td>
    </tr>
</table>
<table style="width:100%;page-break-after:always;table-layout:fixed;">
    <tr>
        <td style="width:8%;">@Html.DisplayNameFor(model => model.AccidentWithAbsence)</td>
        <td style="width:3%;">@Html.DisplayFor(model => model.AccidentWithAbsence)</td>
        <td style="width:8%;">@Html.DisplayNameFor(model => model.AccidentWithoutAbsence)</td>
        <td style="width:3%;">@Html.DisplayFor(model => model.AccidentWithoutAbsence)</td>
        <td style="width:11%;">@Html.DisplayNameFor(model => model.EnvironmentAccident)</td>
        <td style="width:3%;">@Html.DisplayFor(model => model.EnvironmentAccident)</td>
        <td style="width:8%;">@Html.DisplayNameFor(model => model.NearMiss)</td>
        <td style="width:3%;">@Html.DisplayFor(model => model.NearMiss)</td>
        <td style="width:9%;">@Html.DisplayNameFor(model => model.UnsafeConditions)</td>
        <td style="width:3%;">@Html.DisplayFor(model => model.UnsafeConditions)</td>
        <td style="width:8%;">@Html.DisplayNameFor(model => model.Other)</td>
        <td style="width:3%;">@Html.DisplayFor(model => model.Other)</td>
        <td style="width:11%;">@Html.DisplayNameFor(model => model.InjuctionProhibition)</td>
        <td style="width:9%;">@Html.DisplayFor(model => model.InjuctionProhibition)</td>
        <td style="width:8%;">@Html.DisplayNameFor(model => model.HJSubContractor)</td>
        <td style="width:4%;">@Html.DisplayFor(model => model.HJSubContractor)</td>
    </tr>
    <tr style="background-color:yellow;font-size:large">
        <td colspan="16" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("What was the process - what happened?")</td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhatHappened))</td>
        <td colspan="12"><textarea asp-for="WhatHappened" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.NameOfInjured))</td>
        <td colspan="12"><textarea asp-for="NameOfInjured" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhereAndWhen))</td>
        <td colspan="12"><textarea asp-for="WhereAndWhen" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.NameofWitnesses))</td>
        <td colspan="12"><textarea asp-for="NameofWitnesses" readonly="readonly" cols="80" rows="2" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhatInjury))</td>
        <td colspan="12"><textarea asp-for="WhatInjury" readonly="readonly" cols="80" rows="2" style="border:none;"></textarea></td>
    </tr>
    <tr style="background-color:yellow;font-size:large">
        <td colspan="16" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Description and control of situation")</td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhatWasDoneToFix))</td>
        <td colspan="12"><textarea asp-for="WhatWasDoneToFix" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr style="background-color:yellow;font-size:large">
        <td colspan="16" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("What was the cause - why did it happen")</td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhatCausedAccident))</td>
        <td colspan="12"><textarea asp-for="WhatCausedAccident" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.HowCouldItHappen))</td>
        <td colspan="12"><textarea asp-for="HowCouldItHappen" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WasSafetyProcessInOrder))</td>
        <td colspan="12">@Html.DisplayFor(model => model.WasSafetyProcessInOrder)</td>
    </tr>
    <tr style="background-color:yellow;font-size:large">
        <td colspan="16" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Prevention of similar situations - corrective actions")</td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhatIsDoneToPrevent))</td>
        <td colspan="12"><textarea asp-for="WhatIsDoneToPrevent" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.CauseForChangeInAPV))</td>
        <td colspan="12">@Html.DisplayFor(model => model.CauseForChangeInAPV)</td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhatCanBeLearned))</td>
        <td colspan="12"><textarea asp-for="WhatCanBeLearned" readonly="readonly" cols="80" rows="10" style="border:none;"></textarea></td>
    </tr>
    <tr style="background-color:yellow;font-size:large">
        <td colspan="16" style="text-align:left;">@SharedLocalizer.GetLocalizedHtmlString("Light job (Talk with AMU leader)")</td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.IsOfferedLightJob))</td>
        <td colspan="12">@Html.DisplayFor(model => model.IsOfferedLightJob)</td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.WhatLightJob))</td>
        <td colspan="12"><textarea asp-for="WhatLightJob" readonly="readonly" cols="80" rows="4" style="border:none;"></textarea></td>
    </tr>
    <tr>
        <td colspan="4">@SharedLocalizer.GetLocalizedHtmlString(@Html.DisplayNameFor(model => model.StartLightJob))</td>
        <td colspan="12">@Html.DisplayFor(model => model.StartLightJob)</td>
    </tr>
</table>
<br />
<br />
@Html.DisplayFor(model => model.DoneBy)
<table name="phototable" style="page-break-inside:avoid;width:100%;table-layout:fixed;">
    @{ var rows = 0;}
    @if (Model.SafetyProblem.pictures.Count % 3 == 0)
    {
        rows = Model.SafetyProblem.pictures.Count() / 3;
    }
    else
    {
        rows = Convert.ToInt32(Model.SafetyProblem.pictures.Count() / 3) + 1;
    }
    @{ var totalpics = Model.SafetyProblem.pictures.Count();}
    @for (int i = 0; i < rows; i++)
    {
        @if (totalpics - 3 >= 0) //enough room to add whole row
        {
            <tr>
                <td style="width:33%;"><img src="~/AHAK/SafetyProblems/@Model.SafetyProblem.Id.ToString()/@Model.SafetyProblem.pictures[(i+1)*3 - 3]" style="width:100%;" /></td>
                <td style="width:33%;"><img src="~/AHAK/SafetyProblems/@Model.SafetyProblem.Id.ToString()/@Model.SafetyProblem.pictures[(i+1)*3 - 3 +1]" style="width:100%;" /></td>
                <td style="width:33%;"><img src="~/AHAK/SafetyProblems/@Model.SafetyProblem.Id.ToString()/@Model.SafetyProblem.pictures[(i+1)*3 - 3 +2]" style="width:100%;" /></td>
            </tr>
            totalpics -= 3;
        }
        else if (totalpics - 2 >= 0)
        {
            <tr>
                <td style="width:33%;"><img src="~/AHAK/SafetyProblems/@Model.SafetyProblem.Id.ToString()/@Model.SafetyProblem.pictures[(i+1)*3 - 3]" style="width:100%;" /></td>
                <td style="width:33%;"><img src="~/AHAK/SafetyProblems/@Model.SafetyProblem.Id.ToString()/@Model.SafetyProblem.pictures[(i+1)*3 - 3 +1]" style="width:100%;" /></td>
                <td style="width:33%;"></td>
            </tr>
            totalpics -= 2;
        }
        else //enough room to add 1 picture in row
        {
            <tr>
                <td style="width:33%;"><img src="~/AHAK/SafetyProblems/@Model.SafetyProblem.Id.ToString()/@Model.SafetyProblem.pictures[(i+1)*3 - 3]" style="width:100%;" /></td>
                <td style="width:33%;"></td>
                <td style="width:33%;"></td>
            </tr>
            totalpics -= 1;
        }

    }
</table>
